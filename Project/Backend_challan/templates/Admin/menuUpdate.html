<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <!-- My CSS -->
    <link rel="stylesheet" href="/static/Admin/style.css">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> -->

    <title>Mess Management</title>
</head>

<body>


	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<i class='bx bxs-smile'></i>
			<span class="text">Mess Admin</span>
		</a>
		<ul class="side-menu top">
			<li >
				<a href="/index">
					<i class='bx bxs-dashboard' ></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				
				<a href="/menu">
					<i class='bx bx-dish' ></i>
					<span class="text">Menu</span>
				</a>
			</li>
			
			<!-- <li>
				<a href="#">
					<i class='bx bx-user-plus' ></i>
					<span class="text">Add Student</span>
				</a>
			</li> -->
			<li>
				<a href="/students">
					<i class='bx bxs-group' ></i>
					<span class="text">Users

					</span>
				</a>
			</li>
			<li>
				<a href="/todayAttendees">
					<i class='bx bxs-group' ></i>
					<span class="text">Today Attendees
						
					</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li class="active">
				<a href="/settings">
					<i class='bx bxs-cog' ></i>
					<span class="text">Settings</span>
				</a>
			</li>
			<li>
				<a href="/logout" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->


    <!-- CONTENT -->
    <section id="content">
        <!-- NAVBAR -->
        <nav>
            <i class='bx bx-menu'></i>
            <!-- <a href="#" class="nav-link">Categories</a> -->
            <form action="#">
                <div class="form-input">
                    <input type="text" placeholder="text...">
                    <button type="submit" class="text-btn"><i class='bx bx-text'></i></button>
                </div>
            </form>
            <input type="checkbox" id="switch-mode" hidden>
            <label for="switch-mode" class="switch-mode"></label>
            <a href="#" class="notification">
                <i class='bx bxs-bell'></i>
                <span class="num">8</span>
            </a>
            <a href="#" class="profile">
                <img src="img/people.png">
            </a>
        </nav>
        <!-- NAVBAR -->

        <!-- MAIN -->
        <main>


            <ul class="box-info">
				<li>
					<i class='bx bxs-calendar-check'></i>
					<span class="text">
						<h3>1PM - 2:30PM</h3>
						<p>Lunch Timing</p>
					</span>
				</li>
				<li>
					<i class='bx bxs-calendar-check'></i>
					<span class="text">
						<h3>7PM - 9PM</h3>
						<p>Dinner Timing</p>
					</span>
				</li>

				<li>
					<i class='bx bxs-dollar-circle'></i>
					<span class="text">
						<h3>$2543</h3>
						<p>Month's Expenditure</p>
					</span>
				</li>
			</ul>
        </main>
        <div style="width: 500px; margin:10px 0px 100px 300px;">
            <form id="form" action="/menu-update" method="post" enctype="multipart/form-data">

                <div class="mb-3">
                    <label for="day" class="form-label">Select Day:</label>
                    <select name="day" class="form-select" id="selectedOption" aria-label="Default select example">
                        <!-- <option selected id="day">Open this select menu</option> -->
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select>
                    <!-- <div class="mb-3">
                        <input type="text" name="day" class="form-control">
                    </div> -->
                </div>
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Dinner</label>
                    <input type="text" name="dinner" id="dinner" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Dinner Price</label>
                    <input type="text" name="dinnerPrice" id="dinnerPrice" class="form-control">
                </div>


                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Choose Dinner File</label>
                    <input type="file" class="form-control" id="dinnerPic"name="inputFile1" autocomplete="off" required
                        onchange="loadFile(event)">

                </div>
                <img id="output1" width="500" />


                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Lunch</label>
                    <input type="text" id="lunch" class="form-control" name="lunch">
                </div>
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Lunch Price</label>
                    <input type="text" id="lunchPrice" class="form-control" name="lunchPrice">
                </div>



                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">Choose Lunch File</label>
                    <input type="file" class="form-control" id="lunchPic"name="inputFile2" autocomplete="off" required
                        onchange="loadFile2(event)">

                </div>
                <img id="output2" width="500" />


                <input type="submit" class="btn btn-primary" id="menuUpdate" value="Submit">
            </form>
            <!-- MAIN -->
        </div>
    </section>
    <!-- CONTENT -->

    <script src="/static/Admin/script.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <script>
        var loadFile = function (event) {
            var output = document.getElementById('output1');
            output.src = URL.createObjectURL(event.target.files[0]);
            output.onload = function () {
                URL.revokeObjectURL(output.src)
            }
        };
        var loadFile2 = function (event) {
            var output = document.getElementById('output2');
            output.src = URL.createObjectURL(event.target.files[0]);
            output.onload = function () {
                URL.revokeObjectURL(output.src)
            }
        };
        // let text=document.getElementById('')
        $(document).ready(function () {
            $("#selectedOption").change(function () {
                var e = document.getElementById("selectedOption");
                var value = e.value;
                var data = {};
                $.ajax({
                    url: `/api/updateMenu/${value}`, // url where to submit the request
                    type: "GET", // type of action POST || GET
                    data: data,
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",

                    success: function (result) {
                        // you can see the result from the console
                        // tab of the developer tools
                        console.log(result);
                        url="/static/img/"
                        document.getElementById("dinner").value = result["dinner"]
                        document.getElementById("dinnerPrice").value = result["dinnerPrice"]
                        document.getElementById("lunch").value = result["lunch"]
                        document.getElementById("lunchPrice").value = result["lunchPrice"]
                        // document.getElementById("lunchPic").value = url+result["lunchPic"]
                        // document.getElementById("dinnerPic").value = url+result["dinnerPic"]



                    },
                    error: function (xhr, resp, text) {
                        console.log(xhr, resp, text);
                        $('body').append('<h2>Error Occured</h2>')
                    }
                })


            });
            var e = document.getElementById("selectedOption");
            var value = e.value;
            // var text = e.options[e.selectedIndex].text;
            // var formdata = $("#form").serializeArray();
            var data = {};
            // $(formdata).each(function (index, obj) {
            //     data[obj.name] = obj.value;
            // });
            // data = JSON.stringify(data)
            // text = document.getElementById('day').value;






            //         // console.log(data)
            //         console.log(text)
            $.ajax({
                url: `/api/updateMenu/${value}`, // url where to submit the request
                type: "GET", // type of action POST || GET
                data: data,
                dataType: 'json',
                contentType: "application/json; charset=utf-8",

                success: function (result) {
                    // you can see the result from the console
                    // tab of the developer tools
                    console.log(result);
                    document.getElementById("dinner").value = result["dinner"]
                    document.getElementById("dinnerPrice").value = result["dinnerPrice"]
                    document.getElementById("lunch").value = result["lunch"]
                    document.getElementById("lunchPrice").value = result["lunchPrice"]



                },
                error: function (xhr, resp, text) {
                    console.log(xhr, resp, text);
                    $('body').append('<h2>Error Occured</h2>')
                }
            })


        });
    </script>


</body>

</html>